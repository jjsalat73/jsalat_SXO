{
  "workflow": {
    "unique_name": "definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY",
    "name": "Copy(1)-CIRT - Msft Xchange Investigation",
    "title": "Copy(1)-CIRT - Msft Xchange Investigation",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Access Token",
          "type": "datatype.secure_string",
          "description": "Placeholder for the Threat Response access token. This token will be fetched as needed throughout the workflow and this variable should not be modified",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Non-Clean Observables",
          "type": "datatype.string",
          "description": "Placeholder for storing a list of non-clean observables found during the investigation. This includes observables with a disposition of suspicious, malicious, or unknown",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3B0J4zr8QgNF6FNiadrwShvDH7",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Targets",
          "type": "datatype.string",
          "description": "Placeholder for a list of targets from your Threat Response module sightings",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O31FW3F2m0EHxzaziXpvoCM1DPA",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "https://us-cert.cisa.gov/ncas/alerts/aa21-062a",
          "scope": "local",
          "name": "Blog Post URL",
          "type": "datatype.string",
          "description": "The URL of the blog post to investigate. In this workflow, we hard-code this to the post about the Xchange attack",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3HW968siUI0y2y9GvSro07byTd",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "mycompany.service-now.com",
          "scope": "local",
          "name": "ServiceNow Instance URL",
          "type": "datatype.string",
          "description": "The URL of your ServiceNow instance. For example: mycompany.service-now.com",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3O912dDS0xONGg6vvNIduLPMs3",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "AMP Module ID",
          "type": "datatype.string",
          "description": "Placeholder for the instance ID of your AMP module from Threat Response. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Threat Response Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the Threat Response environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "SecureX Environment URL",
          "type": "datatype.string",
          "description": "Placeholder for the URL of the SecureX environment being used. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "[]",
          "scope": "local",
          "name": "Sightings",
          "type": "datatype.string",
          "description": "Placeholder for a list of sightings from your Threat Response modules",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O35XQ2bOS38pHhf5dab3cLn3NUa",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "someone@company.com",
          "scope": "local",
          "name": "Email Addresses to Notify",
          "type": "datatype.string",
          "description": "A list of email addresses to notify when the workflow conducts an investigation and sightings are found. These should be either comma separated or each on their own line",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3PU31j467CRNTmeqSI7I7fb0ou",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "*****",
          "scope": "local",
          "name": "Webex Teams Access Token",
          "type": "datatype.secure_string",
          "description": "The access token to use to authenticate to the Webex Teams API. Information about using a bot, which is what we recommend, can be found here: https://developer.webex.com/docs/bots",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3L4I4AkDJQpbJ0D9tHnR7QV5Ss",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Umbrella Module ID",
          "type": "datatype.string",
          "description": "Placeholder for the instance ID of your Umbrella module from Threat Response. You don't need to provide this, it will be fetched automatically",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3RF64SCE1rdsUml6Qv6zAC2Rqe",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.secure_string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Slack Token",
          "type": "datatype.secure_string",
          "description": "The API token to use when accessing Slack. Information about creating a Slack app can be found here: https://api.slack.com/authentication/basics",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O37OP4SRMdoy0yuI7JSkD02jvPO",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Talos new blog posts",
          "scope": "local",
          "name": "Webex Teams Room Name",
          "type": "datatype.string",
          "description": "The name of the Webex Teams room to post messages to. If using a bot, make sure to invite your bot to the room before attempting to send messages. If you don't want to use Webex, leave this blank",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3T0X0y4iGNVvM5WAIj0jQOc3YM",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.date",
        "properties": {
          "value": "0001-01-01T00:00:00+00:00",
          "scope": "local",
          "name": "Threat Response Token Time",
          "type": "datatype.date",
          "description": "The time at which the Threat Response access token was last fetched. This is used to determine when it's time to fetch a new token and should not be modified",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3UO70hHch2YxsPzZMu6WVdkYZm",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "securex-operations",
          "scope": "local",
          "name": "Slack Channel",
          "type": "datatype.string",
          "description": "The name of the Slack channel to post messages to. If you don't want to use Slack, leave this blank",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3JKR26UI30QGu0Y5sUSeQrFMO7",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Remediation Text",
          "type": "datatype.string",
          "description": "Placeholder used to assemble information about the remediation actions taken",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow uses a Talos blog post about the SolarWinds supply chain attack as a source of intelligence. Using observables extracted from the blog post, it conducts an investigation and looks for sightings within your environment. If there are sightings, a variety of actions are taken including creating a Threat Response incident and casebook, creating a ServiceNow incident, sending a Webex Teams message, sending a message on Slack, and sending an email. The workflow also supports automated remediation (with approval). If the resulting approval task is approved, unknown or suspicious file hashes and domains are blocked using AMP and Umbrella respectively. If there are any target endpoints, Orbital is used to take a forensic snapshot and AMP is used to enable host isolation.\n\nTarget Group: Default TargetGroup\n\nTargets Used: CTR_For_Access_Token, CTR_API, Orbital_For_Access_Token, Email Endpoint, Orbital_Target, Private_CTIA_Target, ServiceNow, Slack, Webex Teams\n\nSteps:\nPlease see: https://cs.co/SXO_docs",
      "display_name": "Copy(1)-CIRT - Msft Xchange Investigation",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint",
            "email.smtp_endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eqi",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01OVDXJUBZ9I44L7lo4t4UlcNy8GyENsp0W",
        "name": "Group",
        "title": "Fetch global variables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "description": "If you have information stored in global variables, you can enable this group and use the set variables it contains to update your local variables with the global variable values",
          "display_name": "Fetch global variables",
          "skip_execution": true
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXK4CZ4I41XVldkyQiiSHTLYli5XjjG",
            "name": "Set Variables",
            "title": "Set local variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Set local variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3L4I4AkDJQpbJ0D9tHnR7QV5Ss$",
                  "variable_value_new": ""
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O37OP4SRMdoy0yuI7JSkD02jvPO$",
                  "variable_value_new": ""
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXK9E6N3E50tVqVOZ3Q6jU0ytvb4oJU",
        "name": "Condition Block",
        "title": "Set the environment URL",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Set the environment URL",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01OVDXKESE54S4YVFg1Kttbuo056d6d2GX2",
            "name": "Condition Branch",
            "title": "Prod NAM",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-nam"
              },
              "continue_on_failure": false,
              "display_name": "Prod NAM",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDXKIFPUSZ0o0tB03h9vcgYvziKAluz0",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$",
                      "variable_value_new": "securex-ao.us.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$",
                      "variable_value_new": "visibility.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDXKP1ZQE605hPxwyaJaWRzaHAy62wfN",
            "name": "Condition Branch",
            "title": "Prod EU",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-eu"
              },
              "continue_on_failure": false,
              "display_name": "Prod EU",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDXKS8WBYT6Kf3DP5wlHbVd9ArPjLpuT",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$",
                      "variable_value_new": "securex-ao.eu.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$",
                      "variable_value_new": "visibility.eu.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDXKXSQGM540TgdcNQtxjVDgoOK0DxD6",
            "name": "Condition Branch",
            "title": "Prod APJC",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "prod-apjc"
              },
              "continue_on_failure": false,
              "display_name": "Prod APJC",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDXL244DB62Y7I95TjVwteNWgCqDRXKn",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$",
                      "variable_value_new": "securex-ao.apjc.security.cisco.com"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$",
                      "variable_value_new": "visibility.apjc.amp.cisco.com"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDXL7YMUJT0ArRPcBvNZSxQK4Cr1Fj8s",
            "name": "Condition Branch",
            "title": "INT",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG.env.variable_01A6C871LSO9A26D0zcBjJoAKgRglrC10aG$",
                "operator": "eqi",
                "right_operand": "int"
              },
              "continue_on_failure": false,
              "display_name": "INT",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDXLCU1MYP4mStgfDrZwBZRCMoZv85KN",
                "name": "Set Variables",
                "title": "Set local environment variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set local environment variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$",
                      "variable_value_new": "ao.int.iroh.site"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$",
                      "variable_value_new": "visibility.int.iroh.site"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXLI2WPY27Uu1GKZRe8t9gdmEucYFlH",
        "name": "Group",
        "title": "Fetch and process blog post",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Fetch and process blog post",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf",
            "name": "Execute Python Script",
            "title": "Fetch and clean blog post",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Fetch and clean blog post",
              "script": "import sys,re,requests\n\n# Get the blog post URL from the script input\nblogUrl = sys.argv[1]\n\n# Request the content of the blog post\nblogRequest = requests.get(blogUrl, headers={ 'User-Agent': 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.3' })\n\n# Make sure the request was successful\nif not blogRequest.status_code == 200:\n    sys.exit(\"Unable to fetch blog content. HTTP code \" + blogRequest.status_code)\n\n# Extract the HTML of the blog post\nblogHtml = blogRequest.text\n\n# Default the blog post to being unavailable in case we can't find it\npostTitle = \"Post Title Unavailable\"\n\n# Attempt to extract the blog post title from the HTML\ntitleMatches = re.search(r'\u003ctitle\u003e([^\u003c]+)\u003c\\/title\u003e', blogHtml, re.MULTILINE)\nif titleMatches:\n    # We found a \u003ctitle\u003e tag, so use that as the title\n    postTitle = titleMatches.group(1)\n    postTitle = postTitle[(postTitle.find(\":\") + 2):]\n    postTitle = postTitle.replace(\"\\\"\", \"'\")\n\n# Strip \u003cscript /\u003e tags\nblogHtml = re.sub(r'\u003cscript\\b[^\u003c]*(?:(?!\u003c\\/script\u003e)\u003c[^\u003c]*)*\u003c\\/script\u003e', '', str(blogHtml), flags=re.DOTALL)\n\n# Strip \u003cstyle /\u003e tags\nblogHtml = re.sub(r'\u003cstyle\\b[^\u003c]*(?:(?!\u003c\\/style\u003e)\u003c[^\u003c]*)*\u003c\\/style\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Strip other HTML\nblogHtml = re.sub(r'\u003c[^\u003c]+?\u003e', '', blogHtml, flags=re.DOTALL)\n\n# Replace new lines with a space\nblogHtml = blogHtml.replace(\"\\n\", \" \")",
              "script_arguments": [
                "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3HW968siUI0y2y9GvSro07byTd$"
              ],
              "script_queries": [
                {
                  "script_query": "blogHtml",
                  "script_query_name": "blogHtml",
                  "script_query_type": "string"
                },
                {
                  "script_query": "postTitle",
                  "script_query_name": "postTitle",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXLUIWJNP4RZmTOePizBGNVKHcE2NV0",
            "name": "Condition Block",
            "title": "Were we able to fetch and clean the blog post?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were we able to fetch and clean the blog post?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01OVDXM1MDC2U4CODUnkP6wPvHFYrYpkd3G",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDXM4JWP937Wsa247sx3D4ZpHonEVyiv",
                    "name": "Completed",
                    "title": "Failed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Failed",
                      "result_message": "Failed to fetch and/or clean the blog post content\n\nPython result: $activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.response_body$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXM9ZZD8D7bzL0GMwRoMEHeMmHcYUpf",
        "name": "Group",
        "title": "Inspect the blog  content",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Inspect the blog  content",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXMJUVYPK3s81it8NVZsZTOvk2mkmcm",
            "name": "Threat Response v2 - Generate Access Token",
            "title": "Threat Response v2 - Generate Access Token",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response v2 - Generate Access Token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "CTR_For_Access_Token"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXMW7Q5OW0q0kel2Mm8OlDZ1vv4ruyt",
            "name": "Set Variables",
            "title": "Set local token variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Set local token variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                  "variable_value_new": "$activity.definition_activity_01OVDXMJUVYPK3s81it8NVZsZTOvk2mkmcm.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                },
                {
                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3UO70hHch2YxsPzZMu6WVdkYZm$",
                  "variable_value_new": "$activity.definition_activity_01OVDXMJUVYPK3s81it8NVZsZTOvk2mkmcm.output.end_time$"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXN5N2FD91S9iRzFQW24Jiij4vonSti",
            "name": "Threat Response v2 - Inspect for Observables",
            "title": "Threat Response v2 - Inspect for Observables",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response v2 - Inspect for Observables",
              "input": {
                "variable_workflow_01KXGKYZX7V1M2gr9pVGA5BZoTbgEQPSzF1": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                "variable_workflow_01KXGKYZX7ZLN1hoeZeh7hwWyjoEUkSJCbg": "$activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.script_queries.blogHtml$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target_group": true
              },
              "workflow_id": "definition_workflow_01KXGKZ0JA96P0p7omD4IdS6zKdw5ECiofU"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXNEUESQ05pp0DUwVO7MVBwV4MMgqrL",
            "name": "JSONPath Query",
            "title": "Test for results",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Test for results",
              "input_json": "$activity.definition_activity_01OVDXN5N2FD91S9iRzFQW24Jiij4vonSti.output.variable_workflow_01KXGKYZX80T50ocjT0xlIvdikhoR0AGB5u$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.[0].value",
                  "jsonpath_query_name": "inspectTest",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXNKJSUM171Z3l3BgisbweFhJtEOoyL",
            "name": "Condition Block",
            "title": "Were there any observables?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were there any observables?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01OVDXNSFUTLK4DzW9pnL8Cn2rN6OgLpkWd",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01OVDXNEUESQ05pp0DUwVO7MVBwV4MMgqrL.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDXNXFDK6C16OmXeDPs0NCoGpgEvCQTY",
                    "name": "Completed",
                    "title": "Nothing to investigate",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Nothing to investigate",
                      "result_message": "The blog post \"$activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.script_queries.postTitle$\" was inspected but no observables to investigate were found",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDXO32LIMK0qKq47rYx14pN5voqymfjG",
            "name": "Read Table from JSON",
            "title": "Convert list of observables to table",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Convert list of observables to table",
              "input_json": "$activity.definition_activity_01OVDXN5N2FD91S9iRzFQW24Jiij4vonSti.output.variable_workflow_01KXGKYZX80T50ocjT0xlIvdikhoR0AGB5u$",
              "jsonpath_query": "$.*",
              "persist_output": true,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "type",
                  "column_type": "string"
                },
                {
                  "column_name": "value",
                  "column_type": "string"
                },
                {
                  "column_name": "disposition",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXOADCINE3jXWxp3vPsr9PVdwiq9YDZ",
        "name": "Group",
        "title": "Deliberate the observables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Deliberate the observables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXOGYR8LW198WmclMESAbbhdU4fkCF6",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01OVDXO32LIMK0qKq47rYx14pN5voqymfjG.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDXOS1TL822UNTGDxYcp94YA92lfsQVF",
                "name": "Threat Response v2 - Deliberate Observable",
                "title": "Threat Response v2 - Deliberate Observable",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response v2 - Deliberate Observable",
                  "input": {
                    "variable_workflow_01KXGQWL4TDTE02Mxh65PHxstnnK3wTcCF2": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                    "variable_workflow_01KXGQWL4THYI5hexa4Ip4LW0UZIJhk4ejv": "$activity.definition_activity_01OVDXOGYR8LW198WmclMESAbbhdU4fkCF6.input.source_array[@].type$",
                    "variable_workflow_01KXGQWL4TLPV5NbUAlHHHQUcco57lEijh9": "$activity.definition_activity_01OVDXOGYR8LW198WmclMESAbbhdU4fkCF6.input.source_array[@].value$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01OVDXP39MD8W4LGk5QWxCSqix9c7aS9nsx",
                "name": "Group",
                "title": "Validate Threat Response token",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Validate Threat Response token",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDXPBVQIEJ1HQKPfbzxx653HDflkwBPg",
                    "name": "Calculate Date Time Difference",
                    "title": "Check token age",
                    "type": "core.calculate_date_time_difference",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Check token age",
                      "original_date": "$activity.definition_activity_01OVDXOS1TL822UNTGDxYcp94YA92lfsQVF.output.end_time$",
                      "skip_execution": false,
                      "subtract_date": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3UO70hHch2YxsPzZMu6WVdkYZm$"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDXPHP5ZPR3B82p78GjsQIrKDAoIA3fl",
                    "name": "Condition Block",
                    "title": "Is it over 8 minutes?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Is it over 8 minutes?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OVDXPMZDF1P0t3z5Nalx1C8kMIzvQCCOI",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01OVDXPBVQIEJ1HQKPfbzxx653HDflkwBPg.output.total_minutes$",
                            "operator": "gte",
                            "right_operand": 8
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDXPSBL9GQ5rM8nR0aNSwrfEsaJtekRk",
                            "name": "Threat Response v2 - Generate Access Token",
                            "title": "Threat Response v2 - Generate Access Token",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response v2 - Generate Access Token",
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "CTR_For_Access_Token"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01OVDXQ3IM6OZ4u7XEckn9NaSYZrDcgHSW9",
                            "name": "Set Variables",
                            "title": "Set local token variables",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set local token variables",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                                  "variable_value_new": "$activity.definition_activity_01OVDXPSBL9GQ5rM8nR0aNSwrfEsaJtekRk.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                                },
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3UO70hHch2YxsPzZMu6WVdkYZm$",
                                  "variable_value_new": "$activity.definition_activity_01OVDXPSBL9GQ5rM8nR0aNSwrfEsaJtekRk.output.end_time$"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01OVDXQE6H18T11dXGI1h8HH92ybP4cHZ2w",
                "name": "Update Row in Table",
                "title": "Update observable table with disposition",
                "type": "core.updaterowintable",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "columns": [
                    {
                      "column_name": "disposition",
                      "column_type": "string"
                    }
                  ],
                  "continue_on_failure": false,
                  "display_name": "Update observable table with disposition",
                  "input_table": "$activity.definition_activity_01OVDXO32LIMK0qKq47rYx14pN5voqymfjG.output.read_table_from_json$",
                  "row": [
                    {
                      "key": "disposition",
                      "type": "string",
                      "value": "$activity.definition_activity_01OVDXOS1TL822UNTGDxYcp94YA92lfsQVF.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                    }
                  ],
                  "rows": {
                    "rows_matching_criteria": true,
                    "where_clause": "type == '$activity.definition_activity_01OVDXOGYR8LW198WmclMESAbbhdU4fkCF6.input.source_array[@].type$' AND value == '$activity.definition_activity_01OVDXOGYR8LW198WmclMESAbbhdU4fkCF6.input.source_array[@].value$'"
                  },
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01OVDXQNKP5IG4OYFgASF7zUWlBOUW4kzB1",
                "name": "Condition Block",
                "title": "Was this observable clean?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was this observable clean?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01OVDXQTM3AGD7gGepjAlYu1B5yGnYyTLxs",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01OVDXOS1TL822UNTGDxYcp94YA92lfsQVF.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$",
                        "operator": "ne",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01OVDXQXXDZEL2Gd3c5LqTorniwz0crh1CS",
                        "name": "Execute Python Script",
                        "title": "Append this observable to the observable JSON",
                        "type": "python3.script",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Append this observable to the observable JSON",
                          "script": "import sys,json\n\n# Parse the existing list of observables\nexisting = json.loads(sys.argv[1])\n\n# Get the new observable information\nnewType = sys.argv[2]\nnewValue = sys.argv[3]\nnewDisposition = sys.argv[4]\n\n# Append the new observable to the list\nexisting.append( { \"type\": newType, \"value\": newValue, \"disposition\": newDisposition } )\n\n# Build the new JSON\nnewJson = json.dumps(existing)",
                          "script_arguments": [
                            "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3B0J4zr8QgNF6FNiadrwShvDH7$",
                            "$activity.definition_activity_01OVDXOGYR8LW198WmclMESAbbhdU4fkCF6.input.source_array[@].type$",
                            "$activity.definition_activity_01OVDXOGYR8LW198WmclMESAbbhdU4fkCF6.input.source_array[@].value$",
                            "$activity.definition_activity_01OVDXOS1TL822UNTGDxYcp94YA92lfsQVF.output.variable_workflow_01KXGQWL4TJCC2W33mfqnp8bURFArcu7cRR$"
                          ],
                          "script_queries": [
                            {
                              "script_query": "newJson",
                              "script_query_name": "newJson",
                              "script_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01OVDXR84JI126iWOr3O8ZdfXfcYtOJoG84",
                        "name": "Set Variables",
                        "title": "Update local observable variable",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Update local observable variable",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3B0J4zr8QgNF6FNiadrwShvDH7$",
                              "variable_value_new": "$activity.definition_activity_01OVDXQXXDZEL2Gd3c5LqTorniwz0crh1CS.output.script_queries.newJson$"
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDXRESYZ0U23j2LF03voN4UkO8YzHQDj",
            "name": "Condition Block",
            "title": "Were all of the observables clean?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Were all of the observables clean?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01OVDXRJGONFV5AKwVdYbnfu7DjkBsdI7Ti",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3B0J4zr8QgNF6FNiadrwShvDH7$",
                    "operator": "eq",
                    "right_operand": "[]"
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDXRMPU4GD7NfscoFXf9kgGIMBqzKWQv",
                    "name": "Completed",
                    "title": "No suspicious observables",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "No suspicious observables",
                      "result_message": "The blog post \"$activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.script_queries.postTitle$\" was investigated but all of the observables were clean",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXRS705OB1AXtAnaofViBGP4hA7qHrB",
        "name": "Group",
        "title": "Enrich the observables",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Enrich the observables",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXRYXXGT12FzmV8khCr6e3SPOPD4UC7",
            "name": "For Each",
            "title": "For each observable",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For each observable",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01OVDXO32LIMK0qKq47rYx14pN5voqymfjG.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDXS6OM9O86lngeBUEyFXNcJ6N0NeWTU",
                "name": "Condition Block",
                "title": "Is this observable clean?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Is this observable clean?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01OVDXSBZULG44DluGcfLTbTqV8gQr9Nezl",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01OVDXRYXXGT12FzmV8khCr6e3SPOPD4UC7.input.source_array[@].disposition$",
                        "operator": "eqi",
                        "right_operand": "Clean"
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01OVDXSG45QTS5kw2FiOw5281HdD62wFYlp",
                        "name": "Continue",
                        "title": "Skip this observable",
                        "type": "logic.continue",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Skip this observable",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01OVDXSLCV29U7n0a2INyjq4btiqwObEezL",
                "name": "Group",
                "title": "Validate Threat Response token",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Validate Threat Response token",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDXSRSDKW83334B6rV4NZHdMaBH1OosK",
                    "name": "Calculate Date Time Difference",
                    "title": "Check token age",
                    "type": "core.calculate_date_time_difference",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Check token age",
                      "original_date": "$activity.definition_activity_01OVDXS6OM9O86lngeBUEyFXNcJ6N0NeWTU.output.end_time$",
                      "skip_execution": false,
                      "subtract_date": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3UO70hHch2YxsPzZMu6WVdkYZm$"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDXSYKLOEX4ZjusuJE95rZBlfiQ29Plj",
                    "name": "Condition Block",
                    "title": "Is it over 8 minutes?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Is it over 8 minutes?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OVDXT4RUSF01mAXKSCvQFoFXWd4p5nU3V",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01OVDXSRSDKW83334B6rV4NZHdMaBH1OosK.output.total_minutes$",
                            "operator": "gte",
                            "right_operand": 8
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDXT9K1T752wymMGps5gtwszWpobUnGs",
                            "name": "Threat Response v2 - Generate Access Token",
                            "title": "Threat Response v2 - Generate Access Token",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response v2 - Generate Access Token",
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "CTR_For_Access_Token"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01OVDXTKF77S52fZ4w1bRobDNqMNmvJq5B7",
                            "name": "Set Variables",
                            "title": "Set local token variables",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set local token variables",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                                  "variable_value_new": "$activity.definition_activity_01OVDXT9K1T752wymMGps5gtwszWpobUnGs.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                                },
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3UO70hHch2YxsPzZMu6WVdkYZm$",
                                  "variable_value_new": "$activity.definition_activity_01OVDXT9K1T752wymMGps5gtwszWpobUnGs.output.end_time$"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01OVDXTUM0ESK0nohxMRLMXgRCHUeyPLxhj",
                "name": "Threat Response v2 - Enrich Observable",
                "title": "Threat Response v2 - Enrich Observable",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response v2 - Enrich Observable",
                  "input": {
                    "variable_workflow_01LFCW7BK9JWU2I0o0vdWjBcKeGI9cTXwLT": "$activity.definition_activity_01OVDXRYXXGT12FzmV8khCr6e3SPOPD4UC7.input.source_array[@].type$",
                    "variable_workflow_01LFCW7BK9RRM61vI2vN9AXklLnXrOFOSdu": "$activity.definition_activity_01OVDXRYXXGT12FzmV8khCr6e3SPOPD4UC7.input.source_array[@].value$",
                    "variable_workflow_01LFCW7BK9SW92Ai5bUZzG2IKUi6lVxRR2Z": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target_group": true
                  },
                  "workflow_id": "definition_workflow_01LFCW7C2Q1BU6Szjo7JqBWHWPmevmW7uIn"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01OVDXU45FQCB6GgFq4moA9qlpzFEVjXnbs",
                "name": "Read Table from JSON",
                "title": "Convert list of enrichments to table",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": true,
                  "display_name": "Convert list of enrichments to table",
                  "input_json": "$activity.definition_activity_01OVDXTUM0ESK0nohxMRLMXgRCHUeyPLxhj.output.variable_workflow_01LFCW7BK9PHR4US5QvFoxwf05w5gnBzrNU$",
                  "jsonpath_query": "$.data[*]",
                  "persist_output": false,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "module",
                      "column_type": "string"
                    },
                    {
                      "column_name": "module_type",
                      "column_type": "string"
                    },
                    {
                      "column_name": "data",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01OVDXUCN4RS11i0j1M8eODkOIQet56sUur",
                "name": "Condition Block",
                "title": "Were we able to convert the results to a table?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Were we able to convert the results to a table?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01OVDXUHRV26E3flsy9w80JErrArMGWnPnm",
                    "name": "Condition Branch",
                    "title": "No",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01OVDXU45FQCB6GgFq4moA9qlpzFEVjXnbs.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "No",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01OVDXUKOU2J14mxAzoaiEG2Lt9fnUkKlRq",
                        "name": "Continue",
                        "title": "Skip this observable",
                        "type": "logic.continue",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Skip this observable",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01OVDXUP0V3F73DOX0TuHjXNn33xmDoPbx5",
                "name": "For Each",
                "title": "For each enriched module",
                "type": "logic.for_each",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "For each enriched module",
                  "skip_execution": false,
                  "source_array": "$activity.definition_activity_01OVDXU45FQCB6GgFq4moA9qlpzFEVjXnbs.output.read_table_from_json$"
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDXUXGXMTC2bsZ11JQ7eFJafzmN2jYYP",
                    "name": "JSONPath Query",
                    "title": "Extract sightings",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": true,
                      "display_name": "Extract sightings",
                      "input_json": "$activity.definition_activity_01OVDXUP0V3F73DOX0TuHjXNn33xmDoPbx5.input.source_array[@].data$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.sightings.count",
                          "jsonpath_query_name": "sightingCount",
                          "jsonpath_query_type": "string"
                        },
                        {
                          "jsonpath_query": "$.sightings.docs",
                          "jsonpath_query_name": "sightingData",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDXV4MU4Y81nQokRGDW0QxAqzvsPmjBA",
                    "name": "Condition Block",
                    "title": "Do we care about this module?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Do we care about this module?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OVDXV9VGD8M4r0ai3TAmMAgXwUw6AGuCd",
                        "name": "Condition Branch",
                        "title": "No sightings, skip it",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01OVDXUXGXMTC2bsZ11JQ7eFJafzmN2jYYP.output.succeeded$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "No sightings, skip it",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDXVEFS8EF1nIdrj4S9QO5NefvVVoJ1r",
                            "name": "Continue",
                            "title": "Skip this module",
                            "type": "logic.continue",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Skip this module",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01OVDXVLRW0S06nlIH5UoxnrbjuFFDncFGB",
                    "name": "Execute Python Script",
                    "title": "Extract sightings and targets",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Extract sightings and targets",
                      "script": "import sys,json\n\n# Get the name of the module being investigated\nmoduleName = sys.argv[1]\n\n# Parse the existing list of sightings and targets\nexistingSightings = json.loads(sys.argv[3])\nexistingTargets = json.loads(sys.argv[4])\n\n# Parse the new sightings\nnewSightings = json.loads(sys.argv[2])\n\n# Loop through each sighting\nfor sighting in newSightings:\n\tsighting[\"module_name\"] = moduleName\n\t\n\t# Append this sighting to the master list\n\texistingSightings.append(sighting)\n\t\n\t# Check if this sighting has any targets\n\tif \"targets\" in sighting.keys() and len(sighting[\"targets\"]) \u003e 0:\n\t\t# Loop through each target\n\t\tfor target in sighting[\"targets\"]:\n\t\t\t# Check if this target is an endpoint\n\t\t\tif target[\"type\"] == \"endpoint\":\n\t\t\t\t# Loop through each observable\n\t\t\t\tfor observable in target[\"observables\"]:\n\t\t\t\t\tif observable[\"type\"] == \"amp_computer_guid\" and not observable in existingTargets:\n\t\t\t\t\t\texistingTargets.append(observable)\n\n# Build the new JSON\nnewSightings = json.dumps(existingSightings)\nnewTargets = json.dumps(existingTargets)",
                      "script_arguments": [
                        "$activity.definition_activity_01OVDXUP0V3F73DOX0TuHjXNn33xmDoPbx5.input.source_array[@].module$",
                        "$activity.definition_activity_01OVDXUXGXMTC2bsZ11JQ7eFJafzmN2jYYP.output.jsonpath_queries.sightingData$",
                        "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O35XQ2bOS38pHhf5dab3cLn3NUa$",
                        "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O31FW3F2m0EHxzaziXpvoCM1DPA$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "newSightings",
                          "script_query_name": "newSightings",
                          "script_query_type": "string"
                        },
                        {
                          "script_query": "newTargets",
                          "script_query_name": "newTargets",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDXVXGR1QM0EApqT2lOaZQrPy1tpZXlk",
                    "name": "Set Variables",
                    "title": "Update local variables",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update local variables",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O35XQ2bOS38pHhf5dab3cLn3NUa$",
                          "variable_value_new": "$activity.definition_activity_01OVDXVLRW0S06nlIH5UoxnrbjuFFDncFGB.output.script_queries.newSightings$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O31FW3F2m0EHxzaziXpvoCM1DPA$",
                          "variable_value_new": "$activity.definition_activity_01OVDXVLRW0S06nlIH5UoxnrbjuFFDncFGB.output.script_queries.newTargets$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXW4BCES36YhT6cZW2MRYugOkVhL7fI",
        "name": "Group",
        "title": "Generate summaries",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Generate summaries",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXWCLTYDQ5J7g30TDZRYZZmfGi5ecD9",
            "name": "Execute Python Script",
            "title": "Convert sighting data to usable text for messaging",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Convert sighting data to usable text for messaging",
              "script": "import sys,json\n\n# Get and parse the sighting data\nsightings = json.loads(sys.argv[1])\n\n# Placeholders for output\nsightingCounts = {}\nmoduleNames = []\ntargets = []\n\n# Loop through each sighting\nfor sighting in sightings:\n\t# If there aren't any targets, initialize that array index to an empty list\n\tif not \"targets\" in sighting:\n\t\tsighting[\"targets\"] = []\n\t\t\n\t# Loop through each target\n\ttargetCount = 0\n\tfor target in sighting[\"targets\"]:\n\t\t# Remove the observed time (so two of the same target aren't considered different)\n\t\tdel target[\"observed_time\"]\n\t\t\n\t\t# Add this target to our master list if it's not already in the list (and count it)\n\t\tif not target in targets:\n\t\t\ttargetCount += 1\n\t\t\ttargets.append(target)\n\t\n\t# Is this module already in our count array?\n\tif sighting[\"module_name\"] in sightingCounts.keys():\n\t\t# Yes, so increment the counts\n\t\tsightingCounts[sighting[\"module_name\"]][\"count\"] += 1\n\t\tsightingCounts[sighting[\"module_name\"]][\"targets\"] += targetCount\n\telse:\n\t\t# No, so add it and its counts\n\t\tsightingCounts[sighting[\"module_name\"]] = {\n\t\t\t\"count\": 1,\n\t\t\t\"targets\": targetCount\n\t\t}\n\t\tmoduleNames.append(sighting[\"module_name\"])\n\n# Placeholders for output\nhtmlSummary = \"\"\nhtmlTruncated = False\nmarkdownSummary = \"\"\nmarkdownTruncated = False\nmrkdwnSummary = \"\"\nmrkdwnTruncated = False\n\n# Loop through the sighting counts\nfor module in moduleNames:\n\t# Make sure the HTML summary (for email and ServiceNow) isn't already too long\n\tif len(htmlSummary.encode(\"utf-8\")) \u003e 4000 and not htmlTruncated:\n\t\t# It's getting too long, so mark the message as truncated (and we'll add a warning later)\n\t\thtmlTruncated = True\n\telif not htmlTruncated:\n\t\t# The message isn't too long, so append this module\n\t\thtmlSummary = htmlSummary + \"\u003cli\u003eModule \u003cstrong\u003e\" + module + \"\u003c/strong\u003e returned \u003cstrong\u003e\" + str(sightingCounts[module][\"count\"]) + \" sightings\u003c/strong\u003e with a total of \u003cstrong\u003e\" + str(sightingCounts[module][\"targets\"]) + \" targets\u003c/strong\u003e\u003c/li\u003e\"\n\t\n\t# Make sure the markdown summary (for Threat Response and Webex) isn't already too long\n\tif len(markdownSummary.encode(\"utf-8\")) \u003e 4000 and not markdownTruncated:\n\t\t# It's getting too long, so add a message indicating that the text was truncated\n\t\tmarkdownSummary = markdownSummary + \"\\n\\n Additional information was available but truncated due to message length\"\n\t\tmarkdownTruncated = True\n\telif not markdownTruncated:\n\t\t# The message isn't too long, so append this module\n\t\tmarkdownSummary = markdownSummary + (\"\\n\" if len(markdownSummary) \u003e 0 else \"\") + \"* Module **\" + module + \"** returned **\" + str(sightingCounts[module][\"count\"]) + \" sightings** with a total of **\" + str(sightingCounts[module][\"targets\"]) + \" targets**\"\n\t\n\t# Make sure the mrkdwn summary (for Slack) isn't already too long\n\tif len(mrkdwnSummary.encode(\"utf-8\")) \u003e 4000 and not mrkdwnTruncated:\n\t\t# It's getting too long, so add a message indicating that the text was truncated\n\t\tmrkdwnSummary = mrkdwnSummary + \"\\n\\n Additional information was available but truncated due to message length\"\n\t\tmrkdwnTruncated = True\n\telif not mrkdwnTruncated:\n\t\t# The message isn't too long, so append this module\n\t\tmrkdwnSummary = mrkdwnSummary + (\"\\n\" if len(mrkdwnSummary) \u003e 0 else \"\") + \"- Module *\" + module + \"* returned *\" + str(sightingCounts[module][\"count\"]) + \" sightings* with a total of *\" + str(sightingCounts[module][\"targets\"]) + \" targets*\"\n\t\n# Finish the HTML summary\nhtmlSummary = \"\u003cul\u003e\" + htmlSummary + \"\u003c/ul\u003e\"\n\nif htmlTruncated:\n\thtmlSummary = htmlSummary + \"\u003cbr /\u003e\u003cbr /\u003e\u003cstrong\u003eAdditional information was available but truncated due to message length\u003c/strong\u003e\"\n\n# Convert the targets to a JSON list\ntargetJson = json.dumps(targets)",
              "script_arguments": [
                "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O35XQ2bOS38pHhf5dab3cLn3NUa$"
              ],
              "script_queries": [
                {
                  "script_query": "htmlSummary",
                  "script_query_name": "htmlSummary",
                  "script_query_type": "string"
                },
                {
                  "script_query": "markdownSummary",
                  "script_query_name": "markdownSummary",
                  "script_query_type": "string"
                },
                {
                  "script_query": "targetJson",
                  "script_query_name": "targetJson",
                  "script_query_type": "string"
                },
                {
                  "script_query": "mrkdwnSummary",
                  "script_query_name": "mrkdwnSummary",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXWJ3QLAI1awSpDbyMpJvyI2vCObxLK",
            "name": "Execute Python Script",
            "title": "Strip observable dispositions",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Strip observable dispositions",
              "script": "import sys,json\n\n# Parse the list of observables\nobservables = json.loads(sys.argv[1])\n\n# Placeholder for output\nplainObservables = []\n\n# Build a new list of plain observables (only type and value fields)\nfor observable in observables:\n\tplainObservables.append({ \"type\": observable[\"type\"], \"value\": observable[\"value\"] })\n\t\nplainObservableJson = json.dumps(plainObservables)",
              "script_arguments": [
                "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3B0J4zr8QgNF6FNiadrwShvDH7$"
              ],
              "script_queries": [
                {
                  "script_query": "plainObservableJson",
                  "script_query_name": "plainObservableJson",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXWOQTS4W2uFletoGHT8T5eKoS1UdGS",
        "name": "Group",
        "title": "Create ITSM ticket",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Create ITSM ticket",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR",
            "name": "ServiceNow - Create Incident",
            "title": "ServiceNow - Create Incident",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "ServiceNow - Create Incident",
              "input": {
                "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "Talos - SolarWinds Investigation",
                "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "An automated investigation into observables related to the SolarWinds supply chain attack was conducted by SecureX orchestration.",
                "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 2,
                "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 1,
                "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "[code]\u003ca href=\"https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$/orch-ui/workflows/$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.output.instance_id$\" target=\"_blank\"\u003eView Workflow\u003c/a\u003e\u003cbr /\u003e\u003cbr /\u003e\u003cu\u003eSighting Summary\u003c/u\u003e:\u003cbr /\u003e$activity.definition_activity_01OVDXWCLTYDQ5J7g30TDZRYZZmfGi5ecD9.output.script_queries.htmlSummary$[/code]",
                "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "securex-orchestration",
                "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "ServiceNow"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXX6USYJI674ofDL97cBNT4JjCPdIv8",
        "name": "Group",
        "title": "Create Threat Response objects",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Create Threat Response objects",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXXDRO8MG5UvSjVlfZ02SkKkXJYyTt0",
            "name": "Threat Response v2 - Create Casebook",
            "title": "Threat Response v2 - Create Casebook",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response v2 - Create Casebook",
              "input": {
                "variable_workflow_01KVOGF4J481T6SCd7uh5fW7n47Q712nleJ": "$activity.definition_activity_01OVDXWJ3QLAI1awSpDbyMpJvyI2vCObxLK.output.script_queries.plainObservableJson$",
                "variable_workflow_01KVOGF4J4FZC0jmaR42b1FbIzVZA19KbYL": "This casebook was generated by SecureX orchestration regarding the Msft Xchange vulnerability attack.\n[Click here]($workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3HW968siUI0y2y9GvSro07byTd$) to view the blog post.\n[Click here](https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3O912dDS0xONGg6vvNIduLPMs3$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$) to view the ServiceNow incident ticket.\n_Sighting Summary_:\n$activity.definition_activity_01OVDXWCLTYDQ5J7g30TDZRYZZmfGi5ecD9.output.script_queries.markdownSummary$",
                "variable_workflow_01KVOGF4J4IG81TQKFjqzLlnFJwiiNwXwSq": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                "variable_workflow_01KVOGF4J4JL52xC9ZXdjYwHt2SvRYkArli": "CISA - Msft Xchange vulnerability",
                "variable_workflow_01KVOMXV9ERSV0M9j1WarflgSG8r5SpZ8b5": "Casebook generated from a CIRT blog post",
                "variable_workflow_01LFBYQJV9FZA2THdEQrMftLyGiiHP65nUq": "amber"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXXS4WPOA5JZ1th5ZtUTw8xAD8pbEH1",
            "name": "Threat Response v2 - Create Incident",
            "title": "Threat Response v2 - Create Incident",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response v2 - Create Incident",
              "input": {
                "variable_workflow_01KVVWMAKJ5X54vaAuNkKq259VyiO5JCeuC": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                "variable_workflow_01KVVWMAKJ9HX4TuMb2g74UqzpRLRxjwlwm": "CISA - Msft Xchange vulnerability",
                "variable_workflow_01KVVWMAKJBSF1Fxv8uLSCRGpOJCxkue4OH": "This casebook was generated by SecureX orchestration regarding the Msft Xchange vulnerability attack.\n[Click here]($workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3HW968siUI0y2y9GvSro07byTd$) to view the blog post.\n[Click here](https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3O912dDS0xONGg6vvNIduLPMs3$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$) to view the ServiceNow incident ticket.\n_Sighting Summary_:\n$activity.definition_activity_01OVDXWCLTYDQ5J7g30TDZRYZZmfGi5ecD9.output.script_queries.markdownSummary$",
                "variable_workflow_01KWIVDCZ7VJU1t9jPK4nZnnwHqnllu7dJm": "New",
                "variable_workflow_01KWIVQVGZKUC0vUPbm3oCvqsYVV036tieP": "High",
                "variable_workflow_01LFBWLGJNHPS450Wh1dwGf1Xqot6KHUTwY": "amber"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXY2T526O63sB3YdUdx30Ehc8Mycflz",
            "name": "Threat Response v2 - Create Relationship",
            "title": "Threat Response v2 - Create Relationship",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response v2 - Create Relationship",
              "input": {
                "variable_workflow_01KWID476NLS63mQo7De2Wk9Q1WAJb0dJXe": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3CUG1anfRTOHIQOaa6P6d2vXUN$",
                "variable_workflow_01KWID476NNBL4xUNZ1ze05KmIr6MTOd2tf": "related-to",
                "variable_workflow_01KWID476NOW27YCzfBvT6jlpfoo4jDNQoS": "",
                "variable_workflow_01KWID476NRV53BPxHqiyGzSy3hiS50IIYt": "",
                "variable_workflow_01KWIOPHDZHRM2nxENJ5E3iBUjDizSHzujd": "$activity.definition_activity_01OVDXXDRO8MG5UvSjVlfZ02SkKkXJYyTt0.output.variable_workflow_01KVOGF4J4HBH1AEO1b5YnhSpqUnFihUeXS$",
                "variable_workflow_01KWIP24K2A5P6ag8merXYIrzb5KHnOSzU3": "$activity.definition_activity_01OVDXXS4WPOA5JZ1th5ZtUTw8xAD8pbEH1.output.variable_workflow_01KVVWMAKJDWL0w7z086xbnRNZMwGcpxweP$",
                "variable_workflow_01LFBZWJ98ZH426APtwKiW7OM9nNQMfT7IA": "amber"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXYFMXPLG4sqCzGmA1nPuLuo3jNEwBV",
        "name": "Group",
        "title": "Update ITSM Ticket",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "display_name": "Update ITSM Ticket",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXYPL7VDP6AxJxAATmPtUM3VznSr0a0",
            "name": "Service Now - Add Work Note to Incident",
            "title": "Service Now - Add Work Note to Incident",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Service Now - Add Work Note to Incident",
              "input": {
                "variable_workflow_01FMQTASNW19F198DyWHV14WHmkxNhmxaQu": "[code]\u003ca href=\"https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/incidents?q=id:$activity.definition_activity_01OVDXXS4WPOA5JZ1th5ZtUTw8xAD8pbEH1.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$\" target=\"_blank\"\u003eView Threat Response Incident\u003c/a\u003e\u003cbr /\u003e\u003ca href=\"https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/investigate?spid=$activity.definition_activity_01OVDXXDRO8MG5UvSjVlfZ02SkKkXJYyTt0.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$\" target=\"_blank\"\u003eInvestigate in Threat Response\u003c/a\u003e[/code]",
                "variable_workflow_01FMQTASNW78T0tgvbFoES84str3rrkOfBq": "v2",
                "variable_workflow_01FMQVGD9LTQK0vkSN3y7c0YHxc5cWQnVRt": "$activity.definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR.output.variable_workflow_01C0F7F9L7IYM3YXHCizJhunwKtPlSJWEWM$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": true,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eqi",
                        "right_operand": "ServiceNow"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01FMQTAT3H5VC4NVbonulAhVztfqidbUGlJ"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDXZ1V7QEK0rVLAkbbiL8JDctzHcGzUp",
        "name": "Group",
        "title": "Create remediation approval",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Create remediation approval",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDXZ8BUJCW18OesXAa2ApHkQLIkC4s8H",
            "name": "Execute Python Script",
            "title": "Generate approval text message",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Generate approval text message",
              "script": "import sys,json\n\n# Parse the observables and targets\nobservables = json.loads(sys.argv[1])\ntargets = json.loads(sys.argv[2])\n\n# Placeholders for output\napprovalText = \"\"\n\n# Loop through each non-clean observable\nfor observable in observables:\n\t# Is this suspicious or unknown?\n\tif not observable[\"disposition\"] in [\"Unknown\", \"Suspicious\"]:\n\t\tcontinue\n\t\n\tapprovalText = approvalText + \"\\n\" + (observable[\"value\"].replace(\".\", \"[.]\") if observable[\"type\"] in [\"domain\", \"url\"] else observable[\"value\"]) + \" (\" + observable[\"type\"] + \")\"\n\n# Are there targets?\nif len(targets) \u003e 0:\n\tapprovalText = approvalText + \"\\n\\nThe following targets will have a forensic snapshot taken and be isolated:\"\n\t\n\t# Loop through each target\n\tfor target in targets:\n\t\tapprovalText = approvalText + \"\\n\" + target[\"value\"] + \" (\" + target[\"type\"] + \")\"",
              "script_arguments": [
                "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3B0J4zr8QgNF6FNiadrwShvDH7$",
                "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O31FW3F2m0EHxzaziXpvoCM1DPA$"
              ],
              "script_queries": [
                {
                  "script_query": "approvalText",
                  "script_query_name": "approvalText",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDXZDN1CNF3HTSTzRLPqoV2BVG0rZzW7",
            "name": "Condition Block",
            "title": "Is remediation necessary?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is remediation necessary?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01OVDXZJHMJ9X1hT8fo8rUtiJLJ5hVvgooz",
                "name": "Condition Branch",
                "title": "Nothing to act on",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01OVDXZ8BUJCW18OesXAa2ApHkQLIkC4s8H.output.script_queries.approvalText$",
                      "operator": "eq",
                      "right_operand": ""
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O31FW3F2m0EHxzaziXpvoCM1DPA$",
                      "operator": "eq",
                      "right_operand": "[]"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Nothing to act on",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDXZNH6OM42qYaI0jiBI8kE8d2wTd0JS",
                    "name": "Completed",
                    "title": "Completed",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "display_name": "Completed",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDXZVZOJPD7WagtkkVByz7VeXKCA0TnD",
            "name": "Create Approval Request",
            "title": "SolarWinds remediation approval",
            "type": "task.approval_request",
            "base_type": "activity",
            "properties": {
              "approval_choices": [
                "Approve",
                "Reject"
              ],
              "assignees": [
                "assignee@company,com"
              ],
              "continue_on_failure": false,
              "display_name": "SolarWinds remediation approval",
              "due_date": {
                "is_relative_time": true,
                "is_specified_date": false,
                "relative_time": {
                  "duration": 2,
                  "time_units": "hours"
                },
                "set_due_date": true
              },
              "expiration_date": {
                "is_relative_time": true,
                "is_specified_date": false,
                "relative_time": {
                  "duration": 2,
                  "time_units": "hours"
                }
              },
              "expiration_status": "Expired",
              "minimum_approvals": 1,
              "priority": "high",
              "skip_execution": false,
              "subject_line": "Msft Xchange vulnerability Investigation Remediation",
              "task_message": "An investigation into Msft Xchange attack intelligence resulted in sightings within your environment. If you approve this task, automated remediation will be performed (based on the workflow configuration) for the observables listed below. If you reject this task, no further action will be taken.\n$activity.definition_activity_01OVDXZ8BUJCW18OesXAa2ApHkQLIkC4s8H.output.script_queries.approvalText$",
              "task_owner": "owner@company.com",
              "task_requestor": "requestor@company.com"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDY04PHEX03d8FdWIdsmAp4im6Jvkw7l",
        "name": "Parallel Block",
        "title": "Send notifications",
        "type": "logic.parallel",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Send notifications",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01OVDY0CQFS8T44h7Zd8eXhft6PcdlPVtoD",
            "name": "Parallel Branch",
            "title": "Send Webex message",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send Webex message",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDY0F6G5HT5L7beOyTzbn66nBEOak9B0",
                "name": "Condition Block",
                "title": "Was a Webex Teams room provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was a Webex Teams room provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01OVDY0MHF5UY0QJiTP4Hou3hk33iSQvaKA",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3T0X0y4iGNVvM5WAIj0jQOc3YM$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01OVDY0R84NU82BJINeEuZS6a7lwtyEk2yw",
                        "name": "Webex Teams - Search for Room",
                        "title": "Webex Teams - Search for Room",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Webex Teams - Search for Room",
                          "input": {
                            "variable_workflow_01FHMU6RWYQWI3QFUEzjWMT7JYBcz5vquuD": "",
                            "variable_workflow_01FHMU6RWYWY822p43LeMi8Lcx89Q9jeyek": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3T0X0y4iGNVvM5WAIj0jQOc3YM$",
                            "variable_workflow_01FHMU6RWYY481TVWDm0BQ1p0rWnqak191l": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3L4I4AkDJQpbJ0D9tHnR7QV5Ss$",
                            "variable_workflow_01FHNGCYY2O6Z0NcPmUDabszT2P4P0oqMNd": ""
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Webex Teams"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01OVDY111X0A77NKemta15ZwmPg4X3CECBp",
                        "name": "Condition Block",
                        "title": "Did we find the room?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Did we find the room?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01OVDY17C6TLN30tSrlTYH5XuILQG5mdikx",
                            "name": "Condition Branch",
                            "title": "Yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01OVDY0R84NU82BJINeEuZS6a7lwtyEk2yw.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "Yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01OVDY1D1YBRR4PtGJ6GXXQ6XUGYtOfX9xO",
                                "name": "Webex Teams - Post Message to Room",
                                "title": "Webex Teams - Post Message to Room",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Webex Teams - Post Message to Room",
                                  "input": {
                                    "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3L4I4AkDJQpbJ0D9tHnR7QV5Ss$",
                                    "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$activity.definition_activity_01OVDY0R84NU82BJINeEuZS6a7lwtyEk2yw.output.variable_workflow_01FHSVE2R6ZTQ6L92WEi0kWgR5T8zhMAUzO$",
                                    "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                                    "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "A Threat Response incident has been created for the blog post [$activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.script_queries.postTitle$]($workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3HW968siUI0y2y9GvSro07byTd$) from CIRT. [Click here](https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/incidents?q=id:$activity.definition_activity_01OVDXXS4WPOA5JZ1th5ZtUTw8xAD8pbEH1.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$) to view the incident or [click here](https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/investigate?spid=$activity.definition_activity_01OVDXXDRO8MG5UvSjVlfZ02SkKkXJYyTt0.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$) to investigate.\n[Click here](https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$/orch-ui/tasks/$activity.definition_activity_01OVDXZVZOJPD7WagtkkVByz7VeXKCA0TnD.output.task_id$) to approve automated remediation.\n[Click here](https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3O912dDS0xONGg6vvNIduLPMs3$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$) to view the ServiceNow incident.\n_Sighting Summary_:\n$activity.definition_activity_01OVDXWCLTYDQ5J7g30TDZRYZZmfGi5ecD9.output.script_queries.markdownSummary$"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Webex Teams"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDY1OJJ4PU1LVyZ49rhKvBSZ1naESAFg",
            "name": "Parallel Branch",
            "title": "Send Slack message",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send Slack message",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDY1R460MA6s6pnhSJn09lSQ4YNFOnst",
                "name": "Condition Block",
                "title": "Was a Slack channel provided?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Was a Slack channel provided?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01OVDY1VYR2L55cSi7yrvjITB6JDfSF0IiB",
                    "name": "Condition Branch",
                    "title": "Yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3JKR26UI30QGu0Y5sUSeQrFMO7$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01OVDY1ZQB0QN7XaAXzc1rEhR9lH0kxOR7e",
                        "name": "Slack - Send Message to Channel",
                        "title": "Slack - Send Message to Channel",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": true,
                          "display_name": "Slack - Send Message to Channel",
                          "input": {
                            "variable_workflow_01HQNZKTLIV8Z5287vTq4qKrS29IMFD3g7H": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3JKR26UI30QGu0Y5sUSeQrFMO7$",
                            "variable_workflow_01HQOXVG5Y94H1B55vC2dK9RzxZSEDLMGkg": "A Threat Response incident has been created for the blog post \u003c$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3HW968siUI0y2y9GvSro07byTd$|$activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.script_queries.postTitle$\u003e from Talos. \u003chttps://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/incidents?q=id:$activity.definition_activity_01OVDXXS4WPOA5JZ1th5ZtUTw8xAD8pbEH1.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$|Click here\u003e to view the incident or \u003chttps://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/investigate?spid=$activity.definition_activity_01OVDXXDRO8MG5UvSjVlfZ02SkKkXJYyTt0.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$|click here\u003e to investigate.\n\n\u003chttps://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$/orch-ui/tasks/$activity.definition_activity_01OVDXZVZOJPD7WagtkkVByz7VeXKCA0TnD.output.task_id$|Click here\u003e to approve automated remediation.\n\n\u003chttps://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3O912dDS0xONGg6vvNIduLPMs3$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$|Click here\u003e to view the ServiceNow incident.\n\n_Sighting Summary_:\n$activity.definition_activity_01OVDXWCLTYDQ5J7g30TDZRYZZmfGi5ecD9.output.script_queries.mrkdwnSummary$",
                            "variable_workflow_01HRF4D5938OI4mcYJ4JF2tkjIAztrs1c2z": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O37OP4SRMdoy0yuI7JSkD02jvPO$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "override_workflow_target_group_criteria": true,
                            "target_group": {
                              "run_on_all_targets": false,
                              "use_criteria": {
                                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                "conditions": [
                                  {
                                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                    "operator": "eqi",
                                    "right_operand": "Slack"
                                  }
                                ]
                              }
                            }
                          },
                          "workflow_id": "definition_workflow_01HQNWMZ0DF0F1hMGyE56KyjIltjC5jQuIY"
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDY2B42XX22MS2rohyEhac0EFxvzRx4Z",
            "name": "Parallel Branch",
            "title": "Send email",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send email",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDY2DKZYDC7gm1FkSCwM3dXA5zTLrn4R",
                "name": "Send Email",
                "title": "Send Email",
                "type": "email.smtp_send_email",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "body": "A Threat Response incident has been created for the blog post \u003ca href=\"$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3HW968siUI0y2y9GvSro07byTd$\"\u003e$activity.definition_activity_01OVDXLOM7RXQ02RVi9EbN87gA8Rj8sjIWf.output.script_queries.postTitle$\u003c/a\u003e from Talos.\u003cbr /\u003e\n\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/incidents?q=id:$activity.definition_activity_01OVDXXS4WPOA5JZ1th5ZtUTw8xAD8pbEH1.output.variable_workflow_01LQB1IH60ROO1jxW6qZj3vj88GYE6CdpUH$\"\u003eClick here\u003c/a\u003e to view the incident.\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3EMO5Tj4nwTYfX480Y3rLa9gMX$/investigate?spid=$activity.definition_activity_01OVDXXDRO8MG5UvSjVlfZ02SkKkXJYyTt0.output.variable_workflow_01LQB3XURV3CD6Girik0OfXDWL0RV2MiDK9$\"\u003eClick here\u003c/a\u003e to investigate.\u003cbr /\u003e\n\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3O912dDS0xONGg6vvNIduLPMs3$/nav_to.do?uri=incident.do?sysparm_query=number=$activity.definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR.output.variable_workflow_01C0EMLG2EEYD14wKqkFjhK8dTwJa20Jihp$\"\u003eClick here\u003c/a\u003e to view the ServiceNow incident\u003cbr /\u003e\n\u003cbr /\u003e\n\u003ca href=\"https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$/orch-ui/tasks/$activity.definition_activity_01OVDXZVZOJPD7WagtkkVByz7VeXKCA0TnD.output.task_id$\"\u003eClick here\u003c/a\u003e to approve automated remediation.\u003cbr /\u003e\n\u003cbr /\u003e\n$activity.definition_activity_01OVDXWCLTYDQ5J7g30TDZRYZZmfGi5ecD9.output.script_queries.htmlSummary$",
                  "continue_if_one_address_valid": false,
                  "continue_on_failure": false,
                  "display_name": "Send Email",
                  "html": true,
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "subject": "SolarWinds Investigation Results",
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "Email Endpoint"
                          }
                        ]
                      }
                    }
                  },
                  "to": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3PU31j467CRNTmeqSI7I7fb0ou$"
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01OVDY2MKH0A53F2bs0yhVAH8Bum4mNEF26",
        "name": "Group",
        "title": "Wait for approval and remediate",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Wait for approval and remediate",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01OVDY2T3Z60A3yUJwczG9IQq4UwTQ78yws",
            "name": "Wait For Event",
            "title": "Wait for approval",
            "type": "task.wait_for_event",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": true,
              "display_name": "Wait for approval",
              "event_info": {
                "add_event": true,
                "event_definition": {
                  "conditions": {
                    "left_operand": "$output.task_id$",
                    "operator": "eq",
                    "right_operand": "$activity.definition_activity_01OVDXZVZOJPD7WagtkkVByz7VeXKCA0TnD.output.task_id$"
                  }
                }
              },
              "event_type": "approval_task.event",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01OVDY315TENS4bdgSvjTSaqrbtIGzJI0e5",
            "name": "Condition Block",
            "title": "Was the request approved?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Was the request approved?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01OVDY36WH6KE1lle2UK2OwAH9fzSYQx4oK",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01OVDY2T3Z60A3yUJwczG9IQq4UwTQ78yws.output.response$",
                    "operator": "eqi",
                    "right_operand": "Approve"
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDY3CJ5S4P24JaxfXCgje26MA1PjQ2xw",
                    "name": "Threat Response v2 - Generate Access Token",
                    "title": "Threat Response v2 - Generate Access Token",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Generate Access Token",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eqi",
                                "right_operand": "CTR_For_Access_Token"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDY3N0DTUQ2nuRrXO7FIKbV6vkOnaFzW",
                    "name": "Parallel Block",
                    "title": "Get Threat Response module IDs",
                    "type": "logic.parallel",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Get Threat Response module IDs",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OVDY3S71V6Q01K0egMCdw8qLFTS1CUFtb",
                        "name": "Parallel Branch",
                        "title": "Get AMP module ID",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Get AMP module ID",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDY3VX6D726MbGnbzrW2b2zvt3tfl2aV",
                            "name": "Threat Response v2 - List Response Actions",
                            "title": "Threat Response v2 - List Response Actions",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Threat Response v2 - List Response Actions",
                              "input": {
                                "variable_workflow_01LN1L19G5QMY2si62lBJsZOMzQiYNcFavH": "ee4ec2a1d909afe0feaffadfef2d9785e447a48217c573c9fd9543743d4fd0da",
                                "variable_workflow_01LN1L19G5XT05gbSZsyqyvxyRmPMFnqpby": "$activity.definition_activity_01OVDY3CJ5S4P24JaxfXCgje26MA1PjQ2xw.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                                "variable_workflow_01LN1L19G62JF0LmmycxXMXAJRAwme5cfSX": "sha256"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01LN1L19T0TV005DmQQel75kxFub6INhKKO"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01OVDY4649A2D5e3NKOUCYkg5ZFyd4VoUQb",
                            "name": "Condition Block",
                            "title": "Were actions available?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were actions available?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01OVDY4BMJNY17FBaPthMUh6jls5fwcsluY",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01OVDY3VX6D726MbGnbzrW2b2zvt3tfl2aV.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01OVDY4FLRNPS06aha5EYwTi4LOk9y12JZC",
                                    "name": "JSONPath Query",
                                    "title": "Extract AMP actions",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": true,
                                      "display_name": "Extract AMP actions",
                                      "input_json": " $activity.definition_activity_01OVDY3VX6D726MbGnbzrW2b2zvt3tfl2aV.output.variable_workflow_01LN1L19G61AZ0FyrfzhxbvHZKX33SMiztz$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[?(@.module=='AMP for Endpoints')]",
                                          "jsonpath_query_name": "ampActions",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01OVDY4NW0KXF4BDNlveqFNheQHhttGR9Lu",
                                    "name": "Condition Block",
                                    "title": "Are there AMP actions?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Are there AMP actions?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01OVDY4UX7E1Y0hj9aYLKMaoRFVjGmRXkCt",
                                        "name": "Condition Branch",
                                        "title": "Yes",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01OVDY4FLRNPS06aha5EYwTi4LOk9y12JZC.output.succeeded$",
                                            "operator": "eq",
                                            "right_operand": true
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "Yes",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01OVDY4YMR4L62nPx7UYTsFI11y1i4vGXbN",
                                            "name": "JSONPath Query",
                                            "title": "Extract the module ID",
                                            "type": "corejava.jsonpathquery",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": true,
                                              "display_name": "Extract the module ID",
                                              "input_json": "$activity.definition_activity_01OVDY4FLRNPS06aha5EYwTi4LOk9y12JZC.output.jsonpath_queries.ampActions$",
                                              "jsonpath_queries": [
                                                {
                                                  "jsonpath_query": "$.[0].module_instance_id",
                                                  "jsonpath_query_name": "moduleInstanceId",
                                                  "jsonpath_query_type": "string"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01OVDY56WL5WC0Ur1aWcVlGBs3f7BqaxQyu",
                                            "name": "Condition Block",
                                            "title": "Did that work?",
                                            "type": "logic.if_else",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Did that work?",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01OVDY5BZJ5PH6jYAPfqVFeBRPugwisw8JG",
                                                "name": "Condition Branch",
                                                "title": "Yes",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01OVDY4YMR4L62nPx7UYTsFI11y1i4vGXbN.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": true
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "Yes",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01OVDY5GOW9BE7QrgP5uEMT2q0hRRv1VYP7",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                                          "variable_value_new": "$activity.definition_activity_01OVDY4YMR4L62nPx7UYTsFI11y1i4vGXbN.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01OVDY5NRX2R17CRW7cASLGrz04KgbAcTHT",
                                                "name": "Condition Branch",
                                                "title": "No",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01OVDY4YMR4L62nPx7UYTsFI11y1i4vGXbN.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": false
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "No",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01OVDY5RKTXON66CL5MhQEPbGkzb4k0SWKQ",
                                                    "name": "JSONPath Query",
                                                    "title": "Extract the module ID a different way",
                                                    "type": "corejava.jsonpathquery",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "action_timeout": 180,
                                                      "continue_on_failure": false,
                                                      "display_name": "Extract the module ID a different way",
                                                      "input_json": "$activity.definition_activity_01OVDY4FLRNPS06aha5EYwTi4LOk9y12JZC.output.jsonpath_queries.ampActions$",
                                                      "jsonpath_queries": [
                                                        {
                                                          "jsonpath_query": "$.module_instance_id",
                                                          "jsonpath_query_name": "moduleInstanceId",
                                                          "jsonpath_query_type": "string"
                                                        }
                                                      ],
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01OVDY5Y3KZXH2Gzwol2c7ckAM0vn9dBzOn",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                                          "variable_value_new": "$activity.definition_activity_01OVDY5RKTXON66CL5MhQEPbGkzb4k0SWKQ.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01OVDY65B8Y7D1XLFqZQfKev2O805ECTHk8",
                        "name": "Parallel Branch",
                        "title": "Get Umbrella module ID",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Get Umbrella module ID",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDY6BVLXZD7SAdK1AE7BXBzS78JrAvwQ",
                            "name": "Threat Response v2 - List Response Actions",
                            "title": "Threat Response v2 - List Response Actions",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Threat Response v2 - List Response Actions",
                              "input": {
                                "variable_workflow_01LN1L19G5QMY2si62lBJsZOMzQiYNcFavH": "cisco.com",
                                "variable_workflow_01LN1L19G5XT05gbSZsyqyvxyRmPMFnqpby": "$activity.definition_activity_01OVDY3CJ5S4P24JaxfXCgje26MA1PjQ2xw.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                                "variable_workflow_01LN1L19G62JF0LmmycxXMXAJRAwme5cfSX": "domain"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "use_workflow_target_group": true
                              },
                              "workflow_id": "definition_workflow_01LN1L19T0TV005DmQQel75kxFub6INhKKO"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01OVDY6NBOOHM1gG4CDMlVeWdx7ObtIfvau",
                            "name": "Condition Block",
                            "title": "Were actions available?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Were actions available?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01OVDY6TG5OKM1xefPw8yLQqiCp2fCQdoBb",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01OVDY6BVLXZD7SAdK1AE7BXBzS78JrAvwQ.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01OVDY6XSXAZY5aM8HOC0Mkelc8OQzdGJhO",
                                    "name": "JSONPath Query",
                                    "title": "Extract Umbrella actions",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": true,
                                      "display_name": "Extract Umbrella actions",
                                      "input_json": " $activity.definition_activity_01OVDY6BVLXZD7SAdK1AE7BXBzS78JrAvwQ.output.variable_workflow_01LN1L19G61AZ0FyrfzhxbvHZKX33SMiztz$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[?(@.module=='Umbrella')]",
                                          "jsonpath_query_name": "umbrellaActions",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01OVDY76687L57CHMvrUBV8VZ2d9Y9ZXEng",
                                    "name": "Condition Block",
                                    "title": "Are there Umbrella actions?",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Are there Umbrella actions?",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01OVDY7C2FUUC11J9GyRLHSAhYQ6HOAGyHw",
                                        "name": "Condition Branch",
                                        "title": "Yes",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01OVDY6XSXAZY5aM8HOC0Mkelc8OQzdGJhO.output.succeeded$",
                                            "operator": "eq",
                                            "right_operand": true
                                          },
                                          "continue_on_failure": false,
                                          "display_name": "Yes",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01OVDY7HAZAZA4zgngvwyl4KyL9goOAMaLg",
                                            "name": "JSONPath Query",
                                            "title": "Extract the module ID",
                                            "type": "corejava.jsonpathquery",
                                            "base_type": "activity",
                                            "properties": {
                                              "action_timeout": 180,
                                              "continue_on_failure": true,
                                              "display_name": "Extract the module ID",
                                              "input_json": "$activity.definition_activity_01OVDY6XSXAZY5aM8HOC0Mkelc8OQzdGJhO.output.jsonpath_queries.umbrellaActions$",
                                              "jsonpath_queries": [
                                                {
                                                  "jsonpath_query": "$.[0].module_instance_id",
                                                  "jsonpath_query_name": "moduleInstanceId",
                                                  "jsonpath_query_type": "string"
                                                }
                                              ],
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity"
                                          },
                                          {
                                            "unique_name": "definition_activity_01OVDY7NVHZPA04TjjbC3zBLUJklybYfkbf",
                                            "name": "Condition Block",
                                            "title": "Did that work?",
                                            "type": "logic.if_else",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Did that work?",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01OVDY7TVLHC01fHn9Ivhy9FWL6gkHHBfL9",
                                                "name": "Condition Branch",
                                                "title": "Yes",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01OVDY7HAZAZA4zgngvwyl4KyL9goOAMaLg.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": true
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "Yes",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01OVDY7Z5IU4P0aJtOVR2H1dc66cHLC6riI",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                                          "variable_value_new": "$activity.definition_activity_01OVDY7HAZAZA4zgngvwyl4KyL9goOAMaLg.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01OVDY85SK9RG4jw1HWpsPYCfdUAjqnDIKL",
                                                "name": "Condition Branch",
                                                "title": "No",
                                                "type": "logic.condition_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "condition": {
                                                    "left_operand": "$activity.definition_activity_01OVDY7HAZAZA4zgngvwyl4KyL9goOAMaLg.output.succeeded$",
                                                    "operator": "eq",
                                                    "right_operand": false
                                                  },
                                                  "continue_on_failure": false,
                                                  "display_name": "No",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01OVDY89LM16J3Swba8WhXkIC0dX111LwxA",
                                                    "name": "JSONPath Query",
                                                    "title": "Extract the module ID a different way",
                                                    "type": "corejava.jsonpathquery",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "action_timeout": 180,
                                                      "continue_on_failure": false,
                                                      "display_name": "Extract the module ID a different way",
                                                      "input_json": "$activity.definition_activity_01OVDY6XSXAZY5aM8HOC0Mkelc8OQzdGJhO.output.jsonpath_queries.umbrellaActions$",
                                                      "jsonpath_queries": [
                                                        {
                                                          "jsonpath_query": "$.module_instance_id",
                                                          "jsonpath_query_name": "moduleInstanceId",
                                                          "jsonpath_query_type": "string"
                                                        }
                                                      ],
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01OVDY8HFN0N777aPxUlKn745fwxipeT73T",
                                                    "name": "Set Variables",
                                                    "title": "Set module ID variable",
                                                    "type": "core.set_multiple_variables",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Set module ID variable",
                                                      "skip_execution": false,
                                                      "variables_to_update": [
                                                        {
                                                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3RF64SCE1rdsUml6Qv6zAC2Rqe$",
                                                          "variable_value_new": "$activity.definition_activity_01OVDY89LM16J3Swba8WhXkIC0dX111LwxA.output.jsonpath_queries.moduleInstanceId$"
                                                        }
                                                      ]
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01OVDY8PFR31T7Ce2macvtsnwKCcec9sw5I",
                    "name": "Read Table from JSON",
                    "title": "Convert the observables to a table",
                    "type": "corejava.read_table_from_json",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Convert the observables to a table",
                      "input_json": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3B0J4zr8QgNF6FNiadrwShvDH7$",
                      "jsonpath_query": "$.",
                      "persist_output": false,
                      "populate_columns": false,
                      "skip_execution": false,
                      "table_columns": [
                        {
                          "column_name": "type",
                          "column_type": "string"
                        },
                        {
                          "column_name": "value",
                          "column_type": "string"
                        },
                        {
                          "column_name": "disposition",
                          "column_type": "string"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDY8WQM36V7DzGiZYYhUnjEwVUDqEAgM",
                    "name": "Set Variables",
                    "title": "Update remediation text",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": true,
                      "display_name": "Update remediation text",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                          "variable_value_new": "**Automated remediation approved by $activity.definition_activity_01OVDY2T3Z60A3yUJwczG9IQq4UwTQ78yws.output.assignee_responses[0].assignee$ for workflow instance: https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$/orch-ui/runs/$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.output.instance_id$**\n\n* AMP Module ID: $workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$\n* Umbrella Module ID: $workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3RF64SCE1rdsUml6Qv6zAC2Rqe$\n* Processing $activity.definition_activity_01OVDY8PFR31T7Ce2macvtsnwKCcec9sw5I.output.row_count$ observables"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv",
                    "name": "For Each",
                    "title": "For each observable",
                    "type": "logic.for_each",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "For each observable",
                      "skip_execution": false,
                      "source_array": "$activity.definition_activity_01OVDY8PFR31T7Ce2macvtsnwKCcec9sw5I.output.read_table_from_json$"
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01OVDY9E8M9IB721KIoy6V0THcAPcZkCpAO",
                        "name": "Condition Block",
                        "title": "Is this observable unknown or suspicious?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Is this observable unknown or suspicious?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01OVDY9KTYZPV3Sx59lnBLoFWIbPafGDn0K",
                            "name": "Condition Branch",
                            "title": "No",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].disposition$",
                                  "operator": "ne",
                                  "right_operand": "Unknown"
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].disposition$",
                                  "operator": "ne",
                                  "right_operand": "Suspicious"
                                }
                              },
                              "continue_on_failure": false,
                              "display_name": "No",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01OVDY9QDKC9U2QMeApCQ696vHYbk2aNAXX",
                                "name": "Continue",
                                "title": "Skip this observable",
                                "type": "logic.continue",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Skip this observable",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01OVDY9W03H6X3ezQCrkwylMEfJksQ47fzu",
                        "name": "Condition Block",
                        "title": "Remediate based on observable type",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Remediate based on observable type",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01OVDYA4SMO722cm8rzyeQtyEZ5fSMYGPQ0",
                            "name": "Condition Branch",
                            "title": "sha256",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].type$",
                                "operator": "eqi",
                                "right_operand": "sha256"
                              },
                              "continue_on_failure": false,
                              "display_name": "sha256",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01OVDYA99WY8Y0KlORnxDCgv6KTz6GwVSjo",
                                "name": "Condition Block",
                                "title": "Do we have an AMP module ID?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Do we have an AMP module ID?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01OVDYADZ1N4P0hiFQMhSKxdgbYAhpQWKyp",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                        "operator": "ne",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01OVDYAI90TR45Tbwg2jlU2I5G6Aq6q7i5Y",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                                              "variable_value_new": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$\n* Triggering AMP response action for sha256 hash: $activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].value$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01OVDYAQDKUFM57qGSIi71I8StUOYU40e80",
                                        "name": "Threat Response v2 - Trigger Response Action",
                                        "title": "Threat Response v2 - Trigger Response Action",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Threat Response v2 - Trigger Response Action",
                                          "input": {
                                            "variable_workflow_01LN6IZDPTNMB5pRSd3ZMzyhwlTbZP48rTX": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].type$",
                                            "variable_workflow_01LN6IZDPTRLB7U1KoVCDGKUILR1skREG7m": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].value$",
                                            "variable_workflow_01LN6IZDPTU0109BkPnBB71keB4fGFc6WUF": "$activity.definition_activity_01OVDY3CJ5S4P24JaxfXCgje26MA1PjQ2xw.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                                            "variable_workflow_01LN6M2W5VH7T23pKBE2H7GaOM4Q1t3GHHt": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                            "variable_workflow_01LN6MA1TB57N3Sg3a3cljrZjle2Uh86FdZ": "amp-add-sha256-scd"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01LN6IZE1Z5WH2mlJ3e0EXoRIJbLEQDRYAa"
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01OVDYB4APEQF2LFONgu2hbxLa9kYBCiJKg",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                        "operator": "eq",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01OVDYB74GVC21jMg7kQRFdr69K2R1msUPs",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                                              "variable_value_new": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$\n* Unable to trigger AMP response action for sha256 hash: $activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].value$ (no AMP module detected)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01OVDYBE7LN0V5p9EZmJDabcKUlkTvyOIZn",
                            "name": "Condition Branch",
                            "title": "Domain",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].type$",
                                "operator": "eqi",
                                "right_operand": "domain"
                              },
                              "continue_on_failure": false,
                              "display_name": "Domain",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01OVDYBIFZTP51SUTIulWA8mPrs3Fn7u9Ch",
                                "name": "Replace String",
                                "title": "Sanitize the domain",
                                "type": "core.replacestring",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Sanitize the domain",
                                  "input_string": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].value$",
                                  "replace_list": [
                                    {
                                      "replaced_string": ".",
                                      "replacement_string": "[.]"
                                    }
                                  ],
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01OVDYBSXCE2B2CJDQLaHQk69qrtT6VwtIb",
                                "name": "Condition Block",
                                "title": "Do we have an Umbrella module ID?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Do we have an Umbrella module ID?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01OVDYBYWSENS48m0XOe0P1ulNtWnxmxW2S",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3RF64SCE1rdsUml6Qv6zAC2Rqe$",
                                        "operator": "ne",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01OVDYC2UNXW16CRs0YounF4qtqMX8Oj35O",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                                              "variable_value_new": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$\n* Triggering Umbrella response action for domain: $activity.definition_activity_01OVDYBIFZTP51SUTIulWA8mPrs3Fn7u9Ch.output.result_string$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01OVDYCFF2LPM1HQEx3oSRUmxfRn0qpTmNm",
                                        "name": "Threat Response v2 - Trigger Response Action",
                                        "title": "Threat Response v2 - Trigger Response Action",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Threat Response v2 - Trigger Response Action",
                                          "input": {
                                            "variable_workflow_01LN6IZDPTNMB5pRSd3ZMzyhwlTbZP48rTX": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].type$",
                                            "variable_workflow_01LN6IZDPTRLB7U1KoVCDGKUILR1skREG7m": "$activity.definition_activity_01OVDY95KSBAU16xP9W16Iy5vsk0WQJ49Tv.input.source_array[@].value$",
                                            "variable_workflow_01LN6IZDPTU0109BkPnBB71keB4fGFc6WUF": "$activity.definition_activity_01OVDY3CJ5S4P24JaxfXCgje26MA1PjQ2xw.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                                            "variable_workflow_01LN6M2W5VH7T23pKBE2H7GaOM4Q1t3GHHt": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3RF64SCE1rdsUml6Qv6zAC2Rqe$",
                                            "variable_workflow_01LN6MA1TB57N3Sg3a3cljrZjle2Uh86FdZ": "block"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01LN6IZE1Z5WH2mlJ3e0EXoRIJbLEQDRYAa"
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01OVDYCRZA66021T0JzYnqLOxdbitU17mhv",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3RF64SCE1rdsUml6Qv6zAC2Rqe$",
                                        "operator": "eq",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01OVDYCVRNZHS4Vccych0zAXAYQOENQF0t7",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                                              "variable_value_new": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$\n* Unable to trigger Umbrella response action for domain: $activity.definition_activity_01OVDYBIFZTP51SUTIulWA8mPrs3Fn7u9Ch.output.result_string$ (no Umbrella module detected)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01OVDYD3IAV7H3HFtCRhRBJc18aN8iY9e8n",
                    "name": "Read Table from JSON",
                    "title": "Convert the targets to a table",
                    "type": "corejava.read_table_from_json",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Convert the targets to a table",
                      "input_json": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O31FW3F2m0EHxzaziXpvoCM1DPA$",
                      "jsonpath_query": "$.",
                      "persist_output": false,
                      "populate_columns": false,
                      "skip_execution": false,
                      "table_columns": [
                        {
                          "column_name": "type",
                          "column_type": "string"
                        },
                        {
                          "column_name": "value",
                          "column_type": "string"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OVDYDBPTBAK023tZU70osvXVtmt8AkCCc",
                    "name": "Condition Block",
                    "title": "Are there any endpoints to process?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Are there any endpoints to process?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OVDYDGT9O8S4gPdHl1gCtk1g3DssKpP2m",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01OVDYD3IAV7H3HFtCRhRBJc18aN8iY9e8n.output.row_count$",
                            "operator": "gt",
                            "right_operand": 0
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDYDNBQFKY7knfrfBZ3KRoJGBW8eeBGV",
                            "name": "Threat Response v2 - Generate Orbital Access Token",
                            "title": "Threat Response v2 - Generate Orbital Access Token",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Threat Response v2 - Generate Orbital Access Token",
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Orbital_For_Access_Token"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m",
                            "name": "For Each",
                            "title": "For each target",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "For each target",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01OVDYD3IAV7H3HFtCRhRBJc18aN8iY9e8n.output.read_table_from_json$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01OVDYEBPADQ206pKiVRFOrAyUnwp0dx99X",
                                "name": "Orbital - Query Endpoint",
                                "title": "Orbital - Query Endpoint",
                                "type": "workflow.atomic_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "Orbital - Query Endpoint",
                                  "input": {
                                    "variable_workflow_01F4YGKGSPQ4R0cp29F0OqpDcXkjpph7LCH": "",
                                    "variable_workflow_01F4YGKGSPVOT0mTZ6DAQYFbZROdb9xnhdU": "$activity.definition_activity_01OVDYDNBQFKY7knfrfBZ3KRoJGBW8eeBGV.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                                    "variable_workflow_01F4YGKGSPWTB4YpUnQ0yxhqhW0mK5GRc8M": "",
                                    "variable_workflow_01F4YGKGSPZ6U1aJjRQVdPZLfGTDaKUp6aj": "",
                                    "variable_workflow_01F4YGKGSQ0CV4Aoqb5dI0cE4BnX2d363Q6": "$activity.definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m.input.source_array[@].value$",
                                    "variable_workflow_01F4YGKGSQ1G12UKXH09WJ1SniEvSl5Mvix": "",
                                    "variable_workflow_01F5OLF57L9ZO3EqIUyCbALqlT8zl1g2Ewx": false,
                                    "variable_workflow_01F5OPGZKY45B6qt4GZaTWFCQgeubkvxetW": "forensic-snapshot-windows-0.0.6",
                                    "variable_workflow_01F5OQ33Z1FYY6EU9WApPObYDLrXazVhrX6": 5,
                                    "variable_workflow_01F6IYTZNLX4G5pSwr6DIkCQrikF0bhHcja": "",
                                    "variable_workflow_01FBQGUI51HH37Ch8QLjCXWxN0bdvHzSslk": "SolarWinds - Snapshot for $activity.definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m.input.source_array[@].value$"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target_group_criteria": true,
                                    "target_group": {
                                      "run_on_all_targets": false,
                                      "use_criteria": {
                                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                        "conditions": [
                                          {
                                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                            "operator": "eqi",
                                            "right_operand": "Orbital_Target"
                                          }
                                        ]
                                      }
                                    }
                                  },
                                  "workflow_id": "definition_workflow_01F4YGKHBBM2L2SwIZBJ2sKamNjm3QtxeAQ"
                                },
                                "object_type": "definition_activity"
                              },
                              {
                                "unique_name": "definition_activity_01OVDYEN9R66L25eUWpELwx8r2t8CK7cpwN",
                                "name": "Condition Block",
                                "title": "Do we have an AMP module ID?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Do we have an AMP module ID?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01OVDYEUGKH1068rJo3CJv7E1oSgatieysN",
                                    "name": "Condition Branch",
                                    "title": "Yes",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                        "operator": "ne",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01OVDYEXGXFFN1ZFdfhlkjtZkySHpj6Nm9q",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                                              "variable_value_new": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$\n* Executing forensic snapshot and AMP host isolation for GUID: $activity.definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m.input.source_array[@].value$"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01OVDYF8H0JH13yAwoQjmiDFHrpshEdueRg",
                                        "name": "Threat Response v2 - Trigger Response Action",
                                        "title": "Threat Response v2 - Trigger Response Action",
                                        "type": "workflow.atomic_workflow",
                                        "base_type": "subworkflow",
                                        "properties": {
                                          "continue_on_failure": true,
                                          "display_name": "Threat Response v2 - Trigger Response Action",
                                          "input": {
                                            "variable_workflow_01LN6IZDPTNMB5pRSd3ZMzyhwlTbZP48rTX": "$activity.definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m.input.source_array[@].type$",
                                            "variable_workflow_01LN6IZDPTRLB7U1KoVCDGKUILR1skREG7m": "$activity.definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m.input.source_array[@].value$",
                                            "variable_workflow_01LN6IZDPTU0109BkPnBB71keB4fGFc6WUF": "$activity.definition_activity_01OVDY3CJ5S4P24JaxfXCgje26MA1PjQ2xw.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                                            "variable_workflow_01LN6M2W5VH7T23pKBE2H7GaOM4Q1t3GHHt": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                            "variable_workflow_01LN6MA1TB57N3Sg3a3cljrZjle2Uh86FdZ": "amp-start-isolation-amp-computer-guid"
                                          },
                                          "runtime_user": {
                                            "target_default": true
                                          },
                                          "skip_execution": false,
                                          "target": {
                                            "use_workflow_target_group": true
                                          },
                                          "workflow_id": "definition_workflow_01LN6IZE1Z5WH2mlJ3e0EXoRIJbLEQDRYAa"
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01OVDYFJGJLN44S6z3Z8V7Tu6Z0xNnhkDey",
                                    "name": "Condition Branch",
                                    "title": "No",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3G9X7Q8HNhqiAWdMbt9y5fHhXW$",
                                        "operator": "eq",
                                        "right_operand": ""
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "No",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01OVDYFN2KRY21t5noHoljtJnrwOYptNeAF",
                                        "name": "Set Variables",
                                        "title": "Update remediation text",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Update remediation text",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                                              "variable_value_new": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$\n* Triggered forensic snapshot for GUID: $activity.definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m.input.source_array[@].value$\n* Unable to trigger AMP host isolation for GUID: $activity.definition_activity_01OVDYDWRE5W13jUbTqXn4dRxD0rN6rG53m.input.source_array[@].value$ (no AMP module detected)"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01OVDYFTWYT0R6PwQC4PA3tMFDG4V6n4P4G",
                "name": "Condition Branch",
                "title": "Rejected",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01OVDY2T3Z60A3yUJwczG9IQq4UwTQ78yws.output.response$",
                    "operator": "eqi",
                    "right_operand": "Reject"
                  },
                  "continue_on_failure": false,
                  "display_name": "Rejected",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDYFXG4UN47INyFm4bwFhVJ8YeBCxrRF",
                    "name": "Set Variables",
                    "title": "Update remediation text",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update remediation text",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                          "variable_value_new": "**Automated remediation was rejected by $activity.definition_activity_01OVDY2T3Z60A3yUJwczG9IQq4UwTQ78yws.output.assignee_responses[0].assignee$ for workflow instance: https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$/orch-ui/runs/$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.output.instance_id$**"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01OVDYG56J0OP7OjZ359uaDlIaWLNsx0F4n",
                "name": "Condition Branch",
                "title": "Something else",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": "$activity.definition_activity_01OVDY2T3Z60A3yUJwczG9IQq4UwTQ78yws.output.response$",
                      "operator": "ne",
                      "right_operand": "Approve"
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$activity.definition_activity_01OVDY2T3Z60A3yUJwczG9IQq4UwTQ78yws.output.response$",
                      "operator": "ne",
                      "right_operand": "Reject"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Something else",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDYG9Y4R5W4KBMiPLtXSRyihF4s4aVxv",
                    "name": "Set Variables",
                    "title": "Update remediation text",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update remediation text",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                          "variable_value_new": "**The approval task for automated SolarWinds investigation remediation was not acted on for workflow instance: https://$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O39DM3V4scUZuvumTF9HB1ujv0V$/orch-ui/runs/$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.output.instance_id$**"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDYGG8UB8304U1WWBzpp2rFkutY8y3GR",
            "name": "Group",
            "title": "Update ITSM Ticket",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Update ITSM Ticket",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01OVDYGNU8BOK0Xa7ziaqBVCfa4urvLyRO4",
                "name": "Service Now - Add Work Note to Incident",
                "title": "Service Now - Add Work Note to Incident",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Service Now - Add Work Note to Incident",
                  "input": {
                    "variable_workflow_01FMQTASNW19F198DyWHV14WHmkxNhmxaQu": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                    "variable_workflow_01FMQTASNW78T0tgvbFoES84str3rrkOfBq": "v2",
                    "variable_workflow_01FMQVGD9LTQK0vkSN3y7c0YHxc5cWQnVRt": "$activity.definition_activity_01OVDXWXKZUOD4rehi62rVvUOPtta2vyjvR.output.variable_workflow_01C0F7F9L7IYM3YXHCizJhunwKtPlSJWEWM$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eqi",
                            "right_operand": "ServiceNow"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01FMQTAT3H5VC4NVbonulAhVztfqidbUGlJ"
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01OVDYGX52D334TPbRo2rEmSeTKC2nCnMlH",
            "name": "Parallel Block",
            "title": "Send notifications",
            "type": "logic.parallel",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Send notifications",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01OVDYH4FKNXT7Fwr9WNl1qkZstVCIqqwpf",
                "name": "Parallel Branch",
                "title": "Send Webex message",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Send Webex message",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDYH6TQAVD1897jDDsGZRQSoiylxOtvl",
                    "name": "Condition Block",
                    "title": "Was a Webex Teams room provided?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was a Webex Teams room provided?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OVDYHCHB9864gudycOc9tuGPj6IFuufoB",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3T0X0y4iGNVvM5WAIj0jQOc3YM$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDYHHFS6UZ6MOxI3LTsl8YYZPklgruzE",
                            "name": "Webex Teams - Search for Room",
                            "title": "Webex Teams - Search for Room",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Webex Teams - Search for Room",
                              "input": {
                                "variable_workflow_01FHMU6RWYQWI3QFUEzjWMT7JYBcz5vquuD": "",
                                "variable_workflow_01FHMU6RWYWY822p43LeMi8Lcx89Q9jeyek": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3T0X0y4iGNVvM5WAIj0jQOc3YM$",
                                "variable_workflow_01FHMU6RWYY481TVWDm0BQ1p0rWnqak191l": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3L4I4AkDJQpbJ0D9tHnR7QV5Ss$",
                                "variable_workflow_01FHNGCYY2O6Z0NcPmUDabszT2P4P0oqMNd": ""
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Webex Teams"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU"
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01OVDYHQY2KKP74m6F3vj1S4BtVpnxO8K00",
                            "name": "Condition Block",
                            "title": "Did we find the room?",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Did we find the room?",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01OVDYHWEX4W36enVC75bIn387zu60A9KDV",
                                "name": "Condition Branch",
                                "title": "Yes",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01OVDYHHFS6UZ6MOxI3LTsl8YYZPklgruzE.output.succeeded$",
                                    "operator": "eq",
                                    "right_operand": true
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Yes",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01OVDYI33USBH5grcegeklzGktgixsdI1l2",
                                    "name": "Webex Teams - Post Message to Room",
                                    "title": "Webex Teams - Post Message to Room",
                                    "type": "workflow.atomic_workflow",
                                    "base_type": "subworkflow",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Webex Teams - Post Message to Room",
                                      "input": {
                                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3L4I4AkDJQpbJ0D9tHnR7QV5Ss$",
                                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$activity.definition_activity_01OVDYHHFS6UZ6MOxI3LTsl8YYZPklgruzE.output.variable_workflow_01FHSVE2R6ZTQ6L92WEi0kWgR5T8zhMAUzO$",
                                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$"
                                      },
                                      "runtime_user": {
                                        "target_default": true
                                      },
                                      "skip_execution": false,
                                      "target": {
                                        "override_workflow_target_group_criteria": true,
                                        "target_group": {
                                          "run_on_all_targets": false,
                                          "use_criteria": {
                                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                            "conditions": [
                                              {
                                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                                "operator": "eqi",
                                                "right_operand": "Webex Teams"
                                              }
                                            ]
                                          }
                                        }
                                      },
                                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01OVDYIGEER8B4pQ9RtpoQQVjtOOLVvuqhN",
                "name": "Parallel Branch",
                "title": "Send Slack message",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": true,
                  "display_name": "Send Slack message",
                  "skip_execution": true
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01OVDYIL5Y3QL2tPXyxVlJt0RWHxgNVdM08",
                    "name": "Condition Block",
                    "title": "Was a Slack channel provided?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was a Slack channel provided?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OVDYIR871IP3A9AcMGrqQBIwBvjsM1pBc",
                        "name": "Condition Branch",
                        "title": "Yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3JKR26UI30QGu0Y5sUSeQrFMO7$",
                            "operator": "ne",
                            "right_operand": ""
                          },
                          "continue_on_failure": false,
                          "display_name": "Yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OVDYIVYKW9T6goKTx8aGV9qIJaMGKNfwX",
                            "name": "Slack - Send Message to Channel",
                            "title": "Slack - Send Message to Channel",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Slack - Send Message to Channel",
                              "input": {
                                "variable_workflow_01HQNZKTLIV8Z5287vTq4qKrS29IMFD3g7H": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3JKR26UI30QGu0Y5sUSeQrFMO7$",
                                "variable_workflow_01HQOXVG5Y94H1B55vC2dK9RzxZSEDLMGkg": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O3MQD1clWHYnZfsI338PjOo0luo$",
                                "variable_workflow_01HRF4D5938OI4mcYJ4JF2tkjIAztrs1c2z": "$workflow.definition_workflow_01OVDXJ3XP6EF37YeyclZOEnFjk5i3OMzcY.local.variable_workflow_01OVDXJ3O37OP4SRMdoy0yuI7JSkD02jvPO$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                        "operator": "eqi",
                                        "right_operand": "Slack"
                                      }
                                    ]
                                  }
                                }
                              },
                              "workflow_id": "definition_workflow_01HQNWMZ0DF0F1hMGyE56KyjIltjC5jQuIY"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_01OPCZPQ632F71cw9juwLYx4GIRHsUfGHRb"
    ]
  },
  "categories": {
    "category_01OPCZPQ632F71cw9juwLYx4GIRHsUfGHRb": {
      "unique_name": "category_01OPCZPQ632F71cw9juwLYx4GIRHsUfGHRb",
      "name": "TALOS",
      "title": "TALOS",
      "type": "basic.category",
      "base_type": "category",
      "description": "TALOS INTEL based workflows",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU",
    "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf",
    "definition_workflow_01F4YGKHBBM2L2SwIZBJ2sKamNjm3QtxeAQ",
    "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O",
    "definition_workflow_01KXGKZ0JA96P0p7omD4IdS6zKdw5ECiofU",
    "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x",
    "definition_workflow_01LN6IZE1Z5WH2mlJ3e0EXoRIJbLEQDRYAa",
    "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss",
    "definition_workflow_01HQNWMZ0DF0F1hMGyE56KyjIltjC5jQuIY",
    "definition_workflow_01KXGQWLMIDXG563x6DBOvwjfxpH8JrkaRW",
    "definition_workflow_01FMQTAT3H5VC4NVbonulAhVztfqidbUGlJ",
    "definition_workflow_01LFCW7C2Q1BU6Szjo7JqBWHWPmevmW7uIn",
    "definition_workflow_01LN1L19T0TV005DmQQel75kxFub6INhKKO"
  ]
}